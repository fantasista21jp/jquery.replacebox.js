(function(c){c.fn.replacebox=function(a){function q(){h=a.appendTo&&typeof a.appendTo==="object"&&a.appendTo.length>0?a.appendTo:b.children(a.appendTo);h.each(function(g){var d=c(this),e=c(a.handleUp,d),f=c(a.handleDown,d);g===0&&a.handleOff?e.css("visibility","hidden"):e.css("visibility","");e.unbind("click").click(function(){r("up",g);return false});g>=h.length-1&&a.handleOff?f.css("visibility","hidden"):f.css("visibility","");f.unbind("click").click(function(){r("down",g);return false});k.push(d)});
a.sortable===true&&x();s()}function r(g,d){if(y()===true){var e=k[d],f;d=h.index(e);if(e.length!==0){switch(g){case "up":if(d===0)return;f=c(h.get(d-1));break;case "down":if(d>=k.length-1)return;f=c(h.get(d+1));break;default:return}t();if(a.checkFunc(e,f,h,g)!==true)s();else{c.isFunction(a.beforeFunc)&&a.beforeFunc(e,f,h,g);d=e.position();var l=f.position(),i=e.clone(true).appendTo(b),j=f.clone(true).appendTo(b),m=i.clone(true).replaceAll(f).css("visibility","hidden"),n=j.clone(true).replaceAll(e).css("visibility",
"hidden");e=m.position();f=n.position();i.css({position:"absolute",top:d.top,left:d.left,zIndex:a.zIndex+1});j.css({position:"absolute",top:l.top,left:l.left,zIndex:a.zIndex});var o=false,p=false;i.animate({top:e.top,left:e.left},a.speed,a.easing,function(){o=true;if(p===true){o=false;u(i,j,m,n,g)}});j.animate({top:f.top,left:f.left},a.speed,a.easing,function(){p=true;if(o===true){p=false;u(i,j,m,n,g)}})}}}}function u(g,d,e,f,l){g.remove();d.remove();e.css("visibility","");f.css("visibility","");
v();c.isFunction(a.afterFunc)&&a.afterFunc(e,f,h,l)}function x(){a.sortableOption=c.extend(a.sortableOption,{items:h,start:function(g,d){c.isFunction(a.sortableBeforeFunc)&&a.sortableBeforeFunc(g,d)},update:function(){a.sortableCheckFunc()===false&&b.sortable("cancel")},stop:function(g,d){v();c.isFunction(a.sortableAfterFunc)&&a.sortableAfterFunc(g,d)},disabled:false});b.sortable(a.sortableOption).disableSelection()}function y(){return c.data(b.get(0),"replacebox-enabled")}function z(){return c.data(b.get(0),
"replacebox-configs")}function s(){c.data(b.get(0),"replacebox-enabled",true);a.sortable===true&&b.sortable("option","disabled",false)}function t(){c.data(b.get(0),"replacebox-enabled",false);a.sortable===false&&b.sortable("option","disabled",true)}function v(){if(typeof a==="string")a=z();if(a!==null){b=c(b.selector);k=[];q()}}var w={appendTo:null,zIndex:999,handleUp:".up",handleDown:".down",handleOff:true,speed:500,easing:"swing",checkFunc:function(){return true},beforeFunc:null,afterFunc:null,
sortable:false,sortableOption:{},sortableCheckFunc:function(){return true},sortableBeforeFunc:null,sortableAfterFunc:null},b=this;if(typeof b!=="object"||b.length!==1)return this;var h,k=[];if(a){if(typeof a==="string"){if(a.match(/^_/))return this;try{eval(a)()}catch(A){"console"in window&&console.log(A)}return this}a=c.extend(w,a)}else a=w;c.data(b.get(0),"replacebox-position",false);if(!b.css("position")||b.css("position")=="static"){c.data(b.get(0),"replacebox-position",!b.css("position")?false:
b.css("position"));b.css("position","relative")}c.data(b.get(0),"replacebox-configs",a);t();q();return this}})(jQuery);
