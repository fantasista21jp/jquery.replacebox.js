!function($){$.fn.replacebox=function(configs){function _set(){$replacechild=configs.appendTo&&"object"==typeof configs.appendTo&&configs.appendTo.length>0?configs.appendTo:$replacebox.children(configs.appendTo),$replacechild.each(function(e){var o=$(this),n=$(configs.handleUp,o),c=$(configs.handleDown,o);0===e&&configs.handleOff?n.css("visibility","hidden"):n.css("visibility",""),n.unbind("click").click(function(){return _move("up",e),!1}),e>=$replacechild.length-1&&configs.handleOff?c.css("visibility","hidden"):c.css("visibility",""),c.unbind("click").click(function(){return _move("down",e),!1}),$replaceboxes.push(o)}),configs.sortable===!0&&_sortable(),enable()}function _move(e,o){if(_getStatus()===!0){var n,c=$replaceboxes[o],i=$replacechild.index(c);if(0!==c.length){switch(e){case"up":if(0===i)return;n=$($replacechild.get(i-1));break;case"down":if(i>=$replaceboxes.length-1)return;n=$($replacechild.get(i+1));break;default:return}if(disable(),configs.checkFunc(c,n,$replacechild,e)!==!0)return void enable();$.isFunction(configs.beforeFunc)&&configs.beforeFunc(c,n,$replacechild,e);var t=c.position(),s=n.position(),l=c.clone(!0).appendTo($replacebox),a=n.clone(!0).appendTo($replacebox),r=l.clone(!0).replaceAll(n).css("visibility","hidden"),p=a.clone(!0).replaceAll(c).css("visibility","hidden"),f=r.position(),b=p.position();l.css({position:"absolute",top:t.top,left:t.left,zIndex:configs.zIndex+1}),a.css({position:"absolute",top:s.top,left:s.left,zIndex:configs.zIndex});var d=!1,u=!1;l.animate({top:f.top,left:f.left},configs.speed,configs.easing,function(){d=!0,u===!0&&(d=!1,_show(l,a,r,p,e))}),a.animate({top:b.top,left:b.left},configs.speed,configs.easing,function(){u=!0,d===!0&&(u=!1,_show(l,a,r,p,e))})}}}function _show(e,o,n,c,i){e.remove(),o.remove(),n.css("visibility",""),c.css("visibility",""),refresh(),$.isFunction(configs.afterFunc)&&configs.afterFunc(n,c,$replacechild,i)}function _sortable(){configs.sortableOption=$.extend(configs.sortableOption,{items:$replacechild,start:function(e,o){$.isFunction(configs.sortableBeforeFunc)&&configs.sortableBeforeFunc(e,o)},update:function(e,o){return configs.sortableCheckFunc(e,o)===!1?void $replacebox.sortable("cancel"):void 0},stop:function(e,o){refresh(),$.isFunction(configs.sortableAfterFunc)&&configs.sortableAfterFunc(e,o)},disabled:!1}),$replacebox.sortable(configs.sortableOption),$replacebox.sortable("option","handle")?$($replacebox.sortable("option","handle"),$replacebox).disableSelection():$replacebox.disableSelection()}function _getStatus(){return $.data($replacebox.get(0),"replacebox-enabled")}function _getConfigs(){return $.data($replacebox.get(0),"replacebox-configs")}function enable(){$.data($replacebox.get(0),"replacebox-enabled",!0),configs.sortable===!0&&$replacebox.sortable({disabled:!1})}function disable(){$.data($replacebox.get(0),"replacebox-enabled",!1),configs.sortable===!0&&$replacebox.sortable({disabled:!0})}function refresh(){"string"==typeof configs&&(configs=_getConfigs()),null!==configs&&($replacebox=$($replacebox.selector),$replaceboxes=[],_set())}function destroy(){var e=_getConfigs(),o=$.data($replacebox.get(0),"replacebox-position");null!==e&&($replacebox.removeData("replacebox-configs").removeData("replacebox-enabled").removeData("replacebox-position"),o!==!1&&$replacebox.css("position",o),$replacebox.each(function(){var o=$(this),n=$(e.handleUp,o),c=$(e.handleDown,o);n.unbind("click"),c.unbind("click")}),e.sortable===!0&&$replacebox.sortable("destroy"))}var defaults={appendTo:null,zIndex:999,handleUp:".up",handleDown:".down",handleOff:!0,speed:500,easing:"swing",checkFunc:function(){return!0},beforeFunc:null,afterFunc:null,sortable:!1,sortableOption:{},sortableCheckFunc:function(){return!0},sortableBeforeFunc:null,sortableAfterFunc:null},$replacebox=this;if("object"!=typeof $replacebox||1!==$replacebox.length)return this;var $replacechild,$replaceboxes=[];if(configs){if("string"==typeof configs){if(configs.match(/^_/))return this;try{eval(configs)()}catch(e){"console"in window&&console.log(e)}return this}configs=$.extend(defaults,configs)}else configs=defaults;return $.data($replacebox.get(0),"replacebox-position",!1),$replacebox.css("position")&&"static"!=$replacebox.css("position")||($.data($replacebox.get(0),"replacebox-position",$replacebox.css("position")?$replacebox.css("position"):!1),$replacebox.css("position","relative")),$.data($replacebox.get(0),"replacebox-configs",configs),disable(),_set(),this}}(jQuery);
