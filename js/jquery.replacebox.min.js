(function(c){c.fn.replacebox=function(a){function q(){h=a.appendTo&&typeof a.appendTo==="object"&&a.appendTo.length>0?a.appendTo:b.children(a.appendTo);h.each(function(g){var f=c(this),d=c(a.handleUp,f),e=c(a.handleDown,f);g===0&&a.handleOff?d.css("visibility","hidden"):d.css("visibility","");d.unbind("click").click(function(){r("up",g);return false});g>=h.length-1&&a.handleOff?e.css("visibility","hidden"):e.css("visibility","");e.unbind("click").click(function(){r("down",g);return false});k.push(f)});
s()}function r(g,f){if(w()===true){var d=k[f],e;f=h.index(d);if(d.length!==0){switch(g){case "up":if(f===0)return;e=c(h.get(f-1));break;case "down":if(f>=k.length-1)return;e=c(h.get(f+1));break;default:return}t();if(a.checkFunc(d,e,h,g)!==true)s();else{c.isFunction(a.beforeFunc)&&a.beforeFunc(d,e,h,g);f=d.position();var l=e.position(),i=d.clone(true).appendTo(b),j=e.clone(true).appendTo(b),m=i.clone(true).replaceAll(e).css("visibility","hidden"),n=j.clone(true).replaceAll(d).css("visibility","hidden");
d=m.position();e=n.position();i.css({position:"absolute",top:f.top,left:f.left,zIndex:a.zIndex+1});j.css({position:"absolute",top:l.top,left:l.left,zIndex:a.zIndex});var o=false,p=false;i.animate({top:d.top,left:d.left},a.speed,a.easing,function(){o=true;if(p===true){o=false;u(i,j,m,n,g)}});j.animate({top:e.top,left:e.left},a.speed,a.easing,function(){p=true;if(o===true){p=false;u(i,j,m,n,g)}})}}}}function u(g,f,d,e,l){g.remove();f.remove();d.css("visibility","");e.css("visibility","");x();c.isFunction(a.afterFunc)&&
a.afterFunc(d,e,h,l)}function w(){return c.data(b.get(0),"replacebox-enabled")}function y(){return c.data(b.get(0),"replacebox-configs")}function s(){c.data(b.get(0),"replacebox-enabled",true)}function t(){c.data(b.get(0),"replacebox-enabled",false)}function x(){if(typeof a==="string")a=y();if(a!==null){b=c(b.selector);k=[];q()}}var v={appendTo:null,zIndex:999,handleUp:".up",handleDown:".down",handleOff:true,speed:500,easing:"swing",checkFunc:function(){return true},beforeFunc:null,afterFunc:null},
b=this;if(typeof b!=="object"||b.length!==1)return this;var h,k=[];if(a){if(typeof a==="string"){if(a.match(/^_/))return this;try{eval(a)()}catch(z){alert(z)}return this}a=c.extend(v,a)}else a=v;c.data(b.get(0),"replacebox-position",false);if(!b.css("position")||b.css("position")=="static"){c.data(b.get(0),"replacebox-position",!b.css("position")?false:b.css("position"));b.css("position","relative")}c.data(b.get(0),"replacebox-configs",a);t();q();return this}})(jQuery);
